y = 0
z = 0
x_sim = function() {
y = runif(1)
x = 100000/((1-y)^(1/3))-100000
x
}
z_sim = function() {
z = 0
z[1] = 1000000
for (i in 2:6)  {
if (z[i-1] > 0) {
z[i] = max(z[i-1] + 5500000 - (100*x_sim()), 0)
}
else  {z[i] = 0}
}
z
}
z_sim()
a = 0
a = c(0:5)
plot(a, z_sim(), type = "b", main = "Simulated Risk", xlab = "Year", ylab = "Assets")
x = 0
y = 0
z = 0
x_sim = function() {
y = runif(1)
x = 100000/((1-y)^(1/3))-100000
x
}
z_sim = function()
{
z = 0
z[1] = 1000000
for (i in 2:6)  {
if (z[i-1] > 0) {
z[i] = max(z[i-1] + 5500000 - (100*x_sim()), 0)
}
else  {z[i] = 0}
}
z
}
z_sim()
a = 0
a = c(0:5)
plot(a, z_sim(), type="b", main = "Simulated Risk", xlab = "Year", ylab = "Assets")
#Probability that company busts
b = 0
bust = function() {
if(any(z_sim()==0)) {
b = 1}
else {b = 0}
b
}
mean(replicate(1000,bust()))
mean(replicate(1000,z_sim()[6]))
#Profit taking
asset_profit1 = function() {
z = 0
p = 0
z[1] = 1000000
for (i in 2:6) {
if(z[i-1] > 0) {
z[i] = max(z[i-1] + 5500000 - (100*x_sim()), 0)
if (z[i] > 1000000) {
z[i] = 1000000
p[i-1] = z[i]-1000000 }
else {z[i] = z[i]; p[i-1]=0}
}
else {z[i] = 0; p[i-1] = 0}
}
z
}
b = 0
bust1 = function() {
if(any(asset_profit1()==0)) {
b = 1}
else {b = 0}
b
}
mean(replicate(1000,bust1()))
mean(replicate(1000,asset_profit1()[6]))
profit = function() {
z = 0
p = 0
z[1] = 1000000
for (i in 2:6) {
if(z[i-1] > 0) {
z[i] = max(z[i-1] + 5500000 - (100*x_sim()), 0)
if (z[i] > 1000000) {
p[i-1] = z[i]-1000000
z[i] = 1000000
}
else {z[i] = z[i]; p[i-1] = 0}
}
else {z[i] = 0; p[i-1] = 0}
}
p
}
mean(replicate(10000,sum(profit())))
#Joel Martinez, Veronica Raleigh, Amanda Marousis
#Final Project STAT 4004
#Project Number 1: Insurance
rm(list=ls())
#Problem 2: rPareto
x = 1:1000000
plot(x, 1-(100000/(x+100000))^3)
x = 0
y = runif(10000)
x = 100000/((1-y)^(1/3)) - 100000
hist(x, probability = T, xlim = c(0,10*10^5))
a = 0
b = 0
a = 1:1000000
b = (3*(100000)^3)/((a+100000)^(3+1)) ##true PDF
lines(a, b, col="red")
#Problem 3: Assets
set.seed(1000)
x = 0
y = 0
z = 0
x_sim = function() {
y = runif(1)
x = 100000/((1-y)^(1/3))-100000
x
}
z_sim = function() {
z = 0
z[1] = 1000000
for (i in 2:6)  {
if (z[i-1] > 0) {
z[i] = max(z[i-1] + 5500000 - (100*x_sim()), 0)
}
else  {z[i] = 0}
}
z
}
z_sim()
a = 0
a = c(0:5)
plot(a, z_sim(), type = "b", main = "Simulated Risk", xlab = "Year", ylab = "Assets")
x = 0
y = 0
z = 0
x_sim = function() {
y = runif(1)
x = 100000/((1-y)^(1/3))-100000
x
}
z_sim = function()
{
z = 0
z[1] = 1000000
for (i in 2:6)  {
if (z[i-1] > 0) {
z[i] = max(z[i-1] + 5500000 - (100*x_sim()), 0)
}
else  {z[i] = 0}
}
z
}
z_sim()
a = 0
a = c(0:5)
plot(a, z_sim(), type="b", main = "Simulated Risk", xlab = "Year", ylab = "Assets")
#Probability that company busts
b = 0
bust = function() {
if(any(z_sim()==0)) {
b = 1}
else {b = 0}
b
}
mean(replicate(1000,bust()))
mean(replicate(1000,z_sim()[6]))
#Profit taking
asset_profit1 = function() {
z = 0
p = 0
z[1] = 1000000
for (i in 2:6) {
if(z[i-1] > 0) {
z[i] = max(z[i-1] + 5500000 - (100*x_sim()), 0)
if (z[i] > 1000000) {
z[i] = 1000000
p[i-1] = z[i]-1000000 }
else {z[i] = z[i]; p[i-1]=0}
}
else {z[i] = 0; p[i-1] = 0}
}
z
}
b = 0
bust1 = function() {
if(any(asset_profit1()==0)) {
b = 1}
else {b = 0}
b
}
mean(replicate(1000,bust1()))
mean(replicate(1000,asset_profit1()[6]))
profit = function() {
z = 0
p = 0
z[1] = 1000000
for (i in 2:6) {
if(z[i-1] > 0) {
z[i] = max(z[i-1] + 5500000 - (100*x_sim()), 0)
if (z[i] > 1000000) {
p[i-1] = z[i]-1000000
z[i] = 1000000
}
else {z[i] = z[i]; p[i-1] = 0}
}
else {z[i] = 0; p[i-1] = 0}
}
p
}
mean(replicate(1000,sum(profit())))
#######################################################################
#                Intro to R- Your first script
#######################################################################
#Tell R to print the phrase "Hello World!" in the console
print("Hello World!")
welcome <- "Hello World"
welcome
1+2
total <- 1+2
total
#Where is everything going to be saved?
#setwd("C:\Users\Denisa\Documents\Rfolder")-this works on MACS
setwd("C:\\Users\\Denisa\\Documents\\Rfolder") #need double backslash on PC
help.start()
?setwd
q()
save.image("~/CMDA/Untitled.RData")
#######################################################################
#                Intro to R- Your first script
#######################################################################
#Tell R to print the phrase "Hello World!" in the console
print("Hello World!")
welcome <- "Hello World"
welcome
1+2
total <- 1+2
total
#Where is everything going to be saved?
#setwd("C:\Users\Denisa\Documents\Rfolder")-this works on MACS
setwd("C:\\Users\\Denisa\\Documents\\Rfolder") #need double backslash on PC
help.start()
?setwd
q()
#######################################################################
#                Intro to R- Your first script
#######################################################################
#Tell R to print the phrase "Hello World!" in the console
print("Hello World!")
welcome <- "Hello World"
welcome
1+2
total <- 1+2
total
print("Hello World!")
welcome <- "Hello World"
welcome
welcome <- "Hello World"
welcome
1+2
total <- 1+2
total
#Where is everything going to be saved?
#setwd("C:\Users\Denisa\Documents\Rfolder")-this works on MACS
setwd("C:\\Users\\Denisa\\Documents\\Rfolder") #need double backslash on PC
#######################################################################
#                Intro to R- Your first script
#######################################################################
#Tell R to print the phrase "Hello World!" in the console
print("Hello World!")
welcome <- "Hello World"
welcome
1+2
total <- 1+2
total
#Where is everything going to be saved?
#setwd("C:\Users\amandamarousis\Documents\CMDA")-this works on MACS
setwd("C:\\Users\\amandamarousis\\Documents\\CMDA") #need double backslash on PC
help.start()
?setwd
q()
speed
dist
cars1[,1]
cars1[,2]
#Problem 2
getwd()
setwd(""C:/Users/amandamarousis/CMDA)
#Problem 3
mydatacsv<- read.table('cars1.csv', sep=',', header=T)
#Problem 4
dim(cars1)
d <- dim(cars1)
d
#The dimension of the data frame is two colums and fifty rows.
#Problem 5
var1 <- cars1[2,2]
var1
#Problem 6
#Speed and distance are the variable names
getwd()
setwd("C:/Users/amandamarousis/CMDA")
getwd()
setwd("C:/Users/amandamarousis/CMDA")
getwd()
setwd("/Users/amandamarousis/CMDA")
getwd()
setwd("\Users\amandamarousis\CMDA")
setwd("/Users/amandamarousis/CMDA")
summary(custdata)
load('exampleData.rData')
names(custdata)
dim(custdata)
class(custdata)
summary(custdata)
uciCar <- read.table(
'http://www.win-vector.com/dfiles/car.data.csv',
sep=',',
header=T
)
summary(uciCar)
View(uciCar)
View(uciCar)
load('credit.Rdata')
load('credit.Rdata')
load('credit.Rdata')
summary(d$Personal.status.and.sex)
View(d)
load('exampleData.rData')
summary(custdata) #for the entire data frame
summary(custdata$is.employed)
summary(custdata$income)
summary(custdata$age)
summary(d$Personal.status.and.sex)
summary(d$Other.debtors/guarantors)
summary(d$Other.debtors/guarantors)
load('credit.Rdata')
summary(d$Personal.status.and.sex)
summary(d$Other.debtors/guarantors)
View(d)
summary(d$Other.debtors/guarantors)
View(hhdata)
View(medianincome)
install.packages("hexbin")
library(hexbin)
help(package=hexbin)
hexbin(custdata2, xbins = 30, shape = 1, xbnds = range(x), ybnds = range(y), xlab = NULL,
ylab = NULL, IDs = FALSE)
hexbin(custdata2, xbins = 30, shape = 1, xbnds = range(age), ybnds = range(income), xlab = NULL,
ylab = NULL, IDs = FALSE)
custdata2 <- subset(custdata,
(custdata$age > 0 & custdata$age < 100
& custdata$income > 0))
hexbin(custdata2, xbins = 30, shape = 1, xbnds = range(age), ybnds = range(income), xlab = NULL,
ylab = NULL, IDs = FALSE)
hexbin(custdata2, xbins = 30, shape = 1, xbnds = range(custdata$age),
ybnds = range(custdata$income), xlab = NULL, ylab = NULL, IDs = FALSE)
ggplot(custdata2, aes(x=age,y=income)) +
geom_point(aes(colour = marital.stat )) +
ylim(0,200000) +
theme_bw() +
ggtitle("Scatterplot of Income vs Age")
library(ggplot2)
ggplot(custdata2, aes(x=age,y=income)) +
geom_point(aes(colour = marital.stat )) +
ylim(0,200000) +
theme_bw() +
ggtitle("Scatterplot of Income vs Age")
ggplot(custdata2, aes(x=age,y=income)) +
geom_point() +
ylim(0,200000) +
theme_bw() +
ggtitle("Scatterplot of Income vs Age")
custdata2 <- subset(custdata,
(custdata$age > 0 & custdata$age < 100
& custdata$income > 0))
x <- rnorm(1000)
y <- rnorm(1000)
hbin <- hexbin(x,y, xbins = 25)
x <- rnorm(custdata2$age)
y <- rnorm(custdata2$income)
hbin <- hexbin(x,y, xbins = 25)
x <- rnorm(custdata2$age)
y <- rnorm(custdata2$income)
hbin <- hexbin(x,y, xbins = 25)
hbin
ggplot(custdata2, aes(x=age, y=income)) + geom_hex(binwidth=c(5, 10000)) +
geom_smooth(color="white", se=F) + ylim(0, 200000)
ggplot(custdata2, aes(x=age,y=income)) +
geom_point() +
ylim(0,200000) +
theme_bw() +
ggtitle("Scatterplot of Income vs Age")
ggplot(custdata2, aes(x=age, y=income)) + geom_hex(binwidth=c(5, 10000)) +
geom_smooth(color="white", se=F) + ylim(0, 200000)
ggplot(custdata2, aes(x=age,y=income)) +
geom_point() +
ylim(0,200000) +
theme_bw() +
ggtitle("Scatterplot of Income vs Age")
View(custdata2)
ggplot(custdata2, aes(x=income,y=num.cars)) +
ylim(0,200000) +
geom_point() +
geom_smooth()+
ggtitle("Scatterplot of Income vs Age") +
theme_bw()
ggplot(custdata2, aes(x=income,y=num.vehicles)) +
ylim(0,200000) +
geom_point() +
geom_smooth()+
ggtitle("Scatterplot of Income vs Number of Vehicles") +
theme_bw()
ggplot(custdata) + geom_bar(aes(x=income,
fill=num.vehicles),
position="fill") +
theme_bw()+
ggtitle("Income vs Number of Vehicles")
ggplot(data.frame(x=income,y=num.vehicles), aes(x=x,y=y)) + geom_line()
ggplot(custdata(x=income,y=num.vehicles), aes(x=x,y=y)) + geom_line()
ggplot(custdata,x=income,y=num.vehicles), aes(x=x,y=y)) + geom_line()
ggplot(custdata,x=income,y=num.vehicles, aes(x=x,y=y)) + geom_line()
ggplot(custdata,x=num.vehicles,y=income, aes(x=x,y=y)) + geom_line()
ggplot(custdata, aes(x=num.cars, y=income)) + geom_hex(binwidth=c(5, 10000)) +
geom_smooth(color="white", se=F) + ylim(0, 200000)
ggplot(custdata, aes(x=num.vehicles, y=income)) + geom_hex(binwidth=c(5, 10000)) +
geom_smooth(color="white", se=F) + ylim(0, 200000)
ggplot(custdata, aes(x=income, y=num.vehicles)) + geom_hex(binwidth=c(5, 10000)) +
geom_smooth(color="white", se=F) + ylim(0, 200000)
ggplot(custdata, aes(x=num.vehicles,y=income)) +
ylim(0,200000) +
geom_point() +
geom_smooth()+
ggtitle("Scatterplot of Income vs Age") +
theme_bw()
ggplot(custdata, aes(x=income,y=num.vehicles)) +
ylim(0,200000) +
geom_point() +
geom_smooth()+
ggtitle("Scatterplot of Income vs Age") +
theme_bw()
ggplot(custdata, aes(x=income,y=num.vehicles)) +
ylim(0,2000) +
geom_point() +
geom_smooth()+
ggtitle("Scatterplot of Income vs Age") +
theme_bw()
View(custdata)
summary(custdata$num.vehicles)
#Problem 2
ggplot(custdata, aes(x=income,y=num.vehicles)) +
ylim(0,6) +
geom_point() +
geom_smooth()+
ggtitle("Scatterplot of Income vs Age") +
theme_bw()
#Problem 2
ggplot(custdata) + geom_bar(aes(x=income,
fill=num.vehicles),
position="fill") +
theme_bw()+
ggtitle("Compare percentages of people uninsured per marital category")
#Problem 2
ggplot(custdata) + geom_bar(aes(x=income, binwidth=x,
fill=num.vehicles),
position="fill") +
theme_bw()+
ggtitle("Compare percentages of people uninsured per marital category")
ggplot(custdata) + geom_bar(aes(x=income, binwidth=5,
fill=num.vehicles),
position="fill") +
theme_bw()+
ggtitle("Compare percentages of people uninsured per marital category")
#Problem 2
ggplot(custdata) + geom_bar(aes(x=num.vehicles,
fill=income),
position="fill") +
theme_bw()+
ggtitle("Compare percentages of people uninsured per marital category")
load('phsample.RData')
load('phsample.RData')
load('phsample.RData')
load('phsample.RData')
View(dhus)
getwd()
setwd("/Users/amandamarousis/CMDA")
#Problem 3
load('phsample.RData')
View(dhus)
View(dpus)
#2.12
psub = subset(dpus,with(dpus,(PINCP>1000)&(ESR==1)&
(PINCP<=250000)&(PERNP>1000)&(PERNP<=250000)&
(WKHP>=40)&(AGEP>=20)&(AGEP<=50)&
(PWGTP1>0)&(COW %in% (1:7))&(SCHL %in% (1:24))))
> summary(dtrain$COW)
Employee of a private for-profit Federal government employee
423 21
Local government employee Private not-for-profit employee
39 55
Self-employed incorporated Self-employed not incorporated
17 16
State government employee
24
